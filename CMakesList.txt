cmake_minimum_required(VERSION 3.20)
project(LiquidChessEngine)

set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Aggressive optimizations
add_compile_options(
    -O3
    -march=native
    -mtune=native
    -flto
    -fno-exceptions
    -fno-rtti
    -fstrict-aliasing
    -funroll-loops
    -ffast-math
    -fopenmp-simd
)

# Platform-specific optimizations
if(CMAKE_SYSTEM_PROCESSOR MATCHES "x86_64")
    add_compile_options(-mavx2 -mbmi2 -mpopcnt)
elseif(CMAKE_SYSTEM_PROCESSOR MATCHES "arm")
    add_compile_options(-march=armv8.2-a+simd)
endif()

# Create Python extension
pybind11_add_module(liquid_chess_cpp
    src/bridge/pybind_module.cpp
    src/board/board.cpp
    src/search/search.cpp
    # ... other sources
)